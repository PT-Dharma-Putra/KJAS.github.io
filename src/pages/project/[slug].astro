---
import Layout from "../../layouts/Layout.astro";
import { projects } from "../../data/projects";

export async function getStaticPaths() {
  return projects.map((project, index) => {
    const nextProject = projects[(index + 1) % projects.length];
    return {
      params: { slug: project.slug },
      props: { project, nextProjectSlug: nextProject.slug },
    };
  });
}

const { project, nextProjectSlug } = Astro.props;
---

<Layout title={`${project.name} | KJAS`}>
  <!-- Navigation Buttons - Top Left Fixed -->
  <div class="fixed top-6 left-6 z-50 flex items-center gap-4">
    <a
      href="/#project"
      class="bg-white/90 backdrop-blur-md p-3 rounded-full shadow-lg text-zinc-800 hover:bg-zinc-800 hover:text-white transition-all duration-300 group ring-1 ring-black/5"
      aria-label="Kembali ke Proyek"
    >
      <span
        class="material-icons-outlined text-2xl group-hover:-translate-x-1 transition-transform"
        >arrow_back</span
      >
    </a>
    <a
      href={`/project/${nextProjectSlug}`}
      class="bg-white/90 backdrop-blur-md px-6 py-3 rounded-full shadow-lg text-zinc-800 hover:bg-zinc-800 hover:text-white transition-all duration-300 flex items-center gap-3 group ring-1 ring-black/5"
    >
      <span class="text-xs font-bold tracking-[0.2em] uppercase"
        >Proyek Berikutnya</span
      >
      <span
        class="material-icons-outlined text-xl group-hover:translate-x-1 transition-transform"
        >arrow_forward</span
      >
    </a>
  </div>

  <!-- Main Content Wrapper - Full Screen Split -->
  <div class="min-h-screen w-full flex flex-col lg:flex-row bg-white">
    <!-- Left: Image Slider (60% width) -->
    <div
      class="w-full lg:w-[60%] bg-[#F5F5F7] relative h-[50vh] lg:h-screen order-2 lg:order-1"
    >
      <div class="swiper detail-slider w-full h-full">
        <div class="swiper-wrapper">
          {
            project.images &&
              project.images.map((image) => (
                <div class="swiper-slide w-full h-full flex items-center justify-center p-8 lg:p-16">
                  <img
                    src={image}
                    alt={project.name}
                    class="w-full h-full object-contain shadow-sm"
                  />
                </div>
              ))
          }
          {
            !project.images && (
              <div class="swiper-slide w-full h-full flex items-center justify-center p-8 lg:p-16">
                <img
                  src={project.img}
                  alt={project.name}
                  class="w-full h-full object-contain shadow-sm"
                />
              </div>
            )
          }
        </div>
        <!-- Slider Navigation -->
        <div
          class="swiper-button-prev !text-zinc-800 bg-white/80 backdrop-blur-md border border-zinc-200 p-8 rounded-full hover:bg-white hover:text-[#8B572A] transition-all shadow-lg left-4 lg:left-8 flex items-center justify-center group"
        >
          <span
            class="material-icons-outlined !text-3xl group-hover:scale-110 transition-transform"
            >keyboard_arrow_left</span
          >
        </div>
        <div
          class="swiper-button-next !text-zinc-800 bg-white/80 backdrop-blur-md border border-zinc-200 p-8 rounded-full hover:bg-white hover:text-[#8B572A] transition-all shadow-lg right-4 lg:right-8 flex items-center justify-center group"
        >
          <span
            class="material-icons-outlined !text-3xl group-hover:scale-110 transition-transform"
            >keyboard_arrow_right</span
          >
        </div>
      </div>

      <!-- Pagination/Indicators can go here if needed -->
    </div>

    <!-- Right: Project Details (40% width) -->
    <div
      class="w-full lg:w-[40%] bg-white text-zinc-800 h-auto lg:h-screen lg:overflow-y-auto order-1 lg:order-2"
    >
      <div class="p-8 lg:p-16 flex flex-col min-h-full justify-center">
        <!-- Header -->
        <div class="mb-12">
          <h1 class="flex flex-col items-start leading-none text-zinc-900 mb-6">
            <span
              class="font-['Great_Vibes'] text-4xl lg:text-5xl text-[#8B572A] mb-2"
              >Proyek</span
            >
            <span
              class="font-sans text-4xl lg:text-6xl font-bold tracking-tight uppercase"
              >{project.name.replace("Project ", "")}</span
            >
          </h1>
          <div class="w-20 h-1 bg-[#8B572A]"></div>
        </div>

        <!-- Description -->
        <div class="space-y-10">
          <div>
            <h2
              class="text-sm font-bold uppercase tracking-[0.2em] text-[#8B572A] mb-4"
            >
              Deskripsi
            </h2>
            <p
              class="text-base lg:text-lg leading-relaxed text-zinc-600 text-justify font-light"
            >
              {project.description}
            </p>
          </div>

          <div>
            <h2
              class="text-sm font-bold uppercase tracking-[0.2em] text-[#8B572A] mb-4"
            >
              Item Furnitur
            </h2>
            <ul class="grid grid-cols-1 gap-3">
              {
                project.furniture.map((item) => (
                  <li class="flex items-start text-zinc-700 font-medium">
                    <span class="w-2 h-2 bg-[#8B572A] rounded-full mr-3 mt-2 flex-shrink-0" />
                    {item}
                  </li>
                ))
              }
            </ul>
          </div>
        </div>

        <!-- Project Specs Grid -->
        <div
          class="grid grid-cols-2 gap-y-8 gap-x-4 mt-16 pt-10 border-t border-zinc-100"
        >
          <div>
            <h4
              class="text-xs font-bold text-zinc-400 uppercase tracking-wider mb-2"
            >
              Tahun
            </h4>
            <p class="text-lg font-semibold text-zinc-900">{project.year}</p>
          </div>
          <div>
            <h4
              class="text-xs font-bold text-zinc-400 uppercase tracking-wider mb-2"
            >
              Klien
            </h4>
            <p class="text-lg font-semibold text-zinc-900 uppercase">
              {project.client}
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</Layout>

<script>
  import Swiper from "swiper";
  import { Navigation, Autoplay, EffectFade } from "swiper/modules";
  import "swiper/css";
  import "swiper/css/navigation";
  import "swiper/css/effect-fade";

  const initSwiper = () => {
    const swiper = new Swiper(".detail-slider", {
      modules: [Navigation, Autoplay, EffectFade],
      effect: "fade",
      fadeEffect: {
        crossFade: true,
      },
      loop: true,
      observer: true,
      observeParents: true,
      autoplay: {
        delay: 4000,
        disableOnInteraction: false,
      },
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
      },
    });
  };

  document.addEventListener("astro:page-load", initSwiper);
  document.addEventListener("DOMContentLoaded", initSwiper);
  initSwiper();
</script>

<style>
  @import url("https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap");

  .font-['Great_Vibes'] {
    font-family: "Great Vibes", cursive;
  }

  .swiper-button-next::after,
  .swiper-button-prev::after {
    display: none !important;
  }
</style>
